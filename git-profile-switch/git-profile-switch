#!/bin/zsh
# Script to switch between different Git SSH configurations

usage() {
    echo "Usage: gps <profile>"
    echo "Profiles: personal | work"
    exit 1
}

if [ $# -eq 0 ]; then
    usage
fi

PROFILE=$1

# Define your profiles here
case $PROFILE in
        personal)
            SSH_KEY="$HOME/.ssh/personal_rsa"
            GIT_EMAIL="your.personal@email.com"
            GIT_NAME="Your Name"
            ;;
        work)
            SSH_KEY="$HOME/.ssh/work_rsa"
            GIT_EMAIL="your.work@email.com"
            GIT_NAME="Your Work Name"
            ;;
        *)
        echo "Error: Unknown profile '$PROFILE'"
        usage
        ;;
esac

if [ ! -f "$SSH_KEY" ]; then
    echo "Error: SSH key not found at $SSH_KEY"
    exit 1
fi

# Switch SSH key and Git config
ssh-add -D > /dev/null 2>&1
ssh-add "$SSH_KEY" 2>&1 | grep -q "Identity added" && echo "✓ SSH key switched" || { echo "✗ Failed to add SSH key"; exit 1; }

git config --global user.email "$GIT_EMAIL"
git config --global user.name "$GIT_NAME"

echo "✓ Switched to $PROFILE profile"
echo "  $(git config --global user.name) <$(git config --global user.email)>"
